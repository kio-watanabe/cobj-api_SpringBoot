aws ecr get-login-password --region ap-northeast-1 --profile ki-watanabe-iam| docker login --username AWS --password-stdin 528794792734.dkr.ecr.ap-northeast-1.amazonaws.com
515f9bb53ee8
docker tag 515f9bb53ee8 528794792734.dkr.ecr.ap-northeast-1.amazonaws.com/spring-boot:latest
docker push 528794792734.dkr.ecr.ap-northeast-1.amazonaws.com/spring-boot:latest
docker push 528794792734.dkr.ecr.ap-northeast-1.amazonaws.com/api-demo:latest
docker tag 2ce2ff1cef31 528794792734.dkr.ecr.ap-northeast-1.amazonaws.com/api-demo:latest
 servicediscovery:ListNamespaces
 cloudformation:CreateStack

 ecr:GetRegistryScanningConfiguration
 CreateRepository

 User: arn:aws:iam::528794792734:user/ki-watanabe-iam is not authorized to perform: cloudformation:CreateStack on resource: arn:aws:cloudformation:ap-northeast-1:528794792734:stack/Infra-ECS-Cluster-api-demo-fdff0233/* because no identity-based policy allows the cloudformation:CreateStack action


 1/26
 * ECSを起動時に、ターゲットグループのヘルスチェックが失敗するという問題が発生した。
    * ターゲットグループのヘルスチェックパスに/loan?loan=30000000&interest_rate=1.5&periods=360を設定した。
    * 正常に動作するようになった。
* ECSサービスの作成と同時にCodeDeployのアプリケーションが作成された。
* 次の作業：フロント側のECSサービスとアプリケーションを作成する。

1/31
* ECSのタスクを作成したとき、セキュリティグループにapi-demo_internet-sgを設定するとネットワークエラーになったが、api-demo_back-sgを設定すると実行できた。
　* api-demo_back-sgにはVPCエンドポイントを設定していたので、それが原因でエラーを解消できたと推測する。


以下、すべての設定をterraformで行ったときのメモ。
3/6
* ECSタスクがどうしても起動できない。エラーになる。
    * api-demo_back-sg(セキュリティグループ)のegressを設定していなかったので、設定したら起動できた。
* フロント側のロードバランサーに設定したターゲットグループのヘルスチェックが正常にならない。
    * api-demo_sg(セキュリティグループ)のegressを設定していなかったので、設定したら起動できた。
    